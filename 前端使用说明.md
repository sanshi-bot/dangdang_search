# 前端使用说明

## 功能说明

前端提供两个主要功能：

### 1. 开始爬取
- **功能**：从当当网爬取图书数据，并自动保存到 MySQL 数据库
- **使用方法**：
  1. 在输入框中输入搜索关键词（如：Python、机器学习、小说等）
  2. 点击"开始爬取"按钮
  3. 等待爬取完成，页面会显示爬取到的图书
  4. 数据会自动保存到数据库中

### 2. 展示数据库数据
- **功能**：从 MySQL 数据库中读取已保存的图书数据
- **使用方法**：
  - **方式1**：输入关键词后点击"展示数据库数据"，显示该关键词的所有图书
  - **方式2**：不输入关键词直接点击"展示数据库数据"，显示数据库中的所有图书

## 接口说明

### 后端 API 接口

1. **爬取接口**：`POST /api/crawl`
   - 功能：爬取图书并保存到数据库
   - 参数：`{ "keyword": "搜索关键词" }`
   - 返回：爬取到的图书列表

2. **展示接口**：`GET /api/books`
   - 功能：从数据库获取图书
   - 参数：`keyword`（可选）- 搜索关键词
   - 返回：数据库中的图书列表

3. **统计接口**：`GET /api/stats`
   - 功能：获取数据库统计信息
   - 返回：图书总数、关键词统计等

## 数据流程

### 爬取流程
```
用户输入关键词 → 点击"开始爬取" → 后端爬取当当网 → 保存到 MySQL → 返回并显示数据
```

### 展示流程
```
用户输入关键词（可选）→ 点击"展示数据库数据" → 后端查询 MySQL → 返回并显示数据
```

## 使用场景

### 场景1：首次使用
1. 输入关键词"Python"
2. 点击"开始爬取"
3. 等待爬取完成，查看结果
4. 数据已保存到数据库

### 场景2：查看已爬取的数据
1. 输入关键词"Python"（或不输入）
2. 点击"展示数据库数据"
3. 立即显示数据库中的数据（无需等待爬取）

### 场景3：更新数据
1. 输入相同的关键词
2. 点击"开始爬取"
3. 新数据会更新数据库中的旧数据（根据 ISBN 去重）

## 注意事项

1. **数据库配置**
   - 确保 MySQL 服务已启动
   - 在 `db_config.py` 中配置正确的数据库密码
   - 设置 `USE_MYSQL = True` 启用数据库存储

2. **爬取速度**
   - 爬取需要时间，请耐心等待
   - 建议每次爬取不要过于频繁，避免被网站限制

3. **数据去重**
   - 使用 ISBN 作为唯一标识
   - 相同 ISBN 的图书会更新而不是重复插入

4. **数据来源标识**
   - 页面会显示数据来源：
     - "爬取并保存到数据库"：刚爬取的数据
     - "数据库"：从数据库读取的数据

## 快速开始

1. **启动后端**
   ```bash
   python backend/api.py
   ```

2. **打开前端**
   - 双击 `frontend/index.html`
   - 或使用 `start_frontend.bat`

3. **开始使用**
   - 输入关键词，点击"开始爬取"
   - 或直接点击"展示数据库数据"查看已有数据

## 常见问题

### Q: 点击"展示数据库数据"显示无数据？
A: 数据库中还没有数据，请先使用"开始爬取"功能爬取数据。

### Q: 爬取失败怎么办？
A: 检查：
1. 后端服务是否启动
2. 网络连接是否正常
3. 数据库配置是否正确

### Q: 如何清空数据库？
A: 使用 MySQL 客户端执行：
```sql
TRUNCATE TABLE books;
```

或使用 Python：
```python
from mysql_db import MySQLDB
db = MySQLDB(password='你的密码')
db.clear_all_books()
db.close()
```
